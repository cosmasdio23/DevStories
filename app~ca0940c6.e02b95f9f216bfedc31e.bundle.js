/*! For license information please see app~ca0940c6.e02b95f9f216bfedc31e.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkstarter_project=self.webpackChunkstarter_project||[]).push([[720],{7861:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(572),o=n(8376),i=n(9791),a=n(5340),c=n(1347);function s(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return u(l,"_invoke",function(n,r,o){var i,c,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function p(n,r){for(c=n,s=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[4]||3,s=i[5]===e?i[3]:i[5],i[4]=3,i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(c=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,c=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),c=l,s=v;(t=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){i=e,c=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),l}var a={};function c(){}function l(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(u(t={},r,(function(){return this})),t),p=d.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,u(p,"constructor",d),u(d,"constructor",l),l.displayName="GeneratorFunction",u(d,o,"GeneratorFunction"),u(p),u(p,o,"Generator"),u(p,r,(function(){return this})),u(p,"toString",(function(){return"[object Generator]"})),(s=function(){return{w:i,m:v}})()}function u(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}u=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){u(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},u(e,t,n,r)}function l(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,c,"next",e)}function c(e){l(i,r,o,a,c,"throw",e)}a(void 0)}))}}n(6879);const f={_presenter:null,_stories:[],render:function(){return d(s().m((function e(){return s().w((function(e){for(;;)if(0===e.n)return e.a(2,'\n      <div class="content feed-container">\n        <h2 class="content__heading">Feed Cerita</h2>\n        <div id="stories-list" class="stories-list">\n          <div class="loader-container"><div class="loader"></div><p>Memuat cerita...</p></div>\n        </div>\n        <a href="#/add-story" class="button button-fab" aria-label="Tambah cerita baru" title="Tambah Cerita Baru">\n          <i class="fas fa-plus"></i>\n        </a>\n      </div>\n    ')}),e)})))()},afterRender:function(){var e=this;return d(s().m((function t(){return s().w((function(t){for(;;)switch(t.n){case 0:return e._presenter=new r.A({view:e,storyApiService:o.A}),e._initStoryActionsListener(),t.n=1,e._presenter.displayStories();case 1:return t.a(2)}}),t)})))()},renderStories:function(e){this._stories=e;var t=document.querySelector("#stories-list");t&&(t.innerHTML="",0!==e.length?(e.forEach((function(e){t.innerHTML+=(0,i.j)(e)})),this._initializeMapsForRenderedStories()):this.showEmptyStoriesMessage())},_initStoryActionsListener:function(){var e=this,t=document.querySelector("#stories-list");t&&t.addEventListener("click",(function(t){var n=t.target,r=n.dataset.storyId;if(r&&e._presenter)if(n.matches(".button-save-offline")){t.stopPropagation();var o=e._stories.find((function(e){return e.id===r}));o&&e._presenter.saveStoryForOffline(o)}else n.matches(".button-delete-offline")&&(t.stopPropagation(),e._presenter.deleteStoryFromIdb(r))}))},updateStoryButtonState:function(e,t){var n=document.querySelector("#story-".concat(e));if(n){var r=this._stories.find((function(t){return t.id===e}));if(r){r.isSaved=t;var o=n.querySelector(".story-item__actions");o&&(o.innerHTML=(0,i.j)(r).match(/<div class="story-item__actions">([\s\S]*)<\/div>/)[1])}}},showLoading:function(){var e=document.querySelector("#stories-list");e&&(e.innerHTML='<div class="loader-container"><div class="loader"></div><p>Memuat cerita...</p></div>')},showEmptyStoriesMessage:function(){var e=document.querySelector("#stories-list");e&&(e.innerHTML='<p class="empty-message">Belum ada cerita yang dibagikan. Jadilah yang pertama!</p>')},showError:function(e){var t=document.querySelector("#stories-list");t&&(t.innerHTML='<p class="error-message">Gagal memuat cerita: '.concat(e,"</p>"))},_initializeMapsForRenderedStories:function(){var e=this;setTimeout((function(){e._stories.forEach((function(e){if(e.lat&&e.lon){var t="map-".concat(e.id),n=document.getElementById(t);n&&null!==n.offsetParent&&a.A.displayStoryMap(t,e.lat,e.lon,e.name)}}))}),200)},redirectToLogin:function(){c.A.info("Sesi Anda berakhir atau Anda belum login. Silakan login kembali."),setTimeout((function(){UserSession.clearSession(),window.location.hash="#/login"}),1500)}}},8397:(e,t,n)=>{n.d(t,{A:()=>m});var r=n(627),o=n(1306),i=n(9083),a=n(8736),c=n(1347);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return l(u,"_invoke",function(n,r,o){var i,c,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function p(n,r){for(c=n,s=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[4]||3,s=i[5]===e?i[3]:i[5],i[4]=3,i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(c=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,c=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),c=l,s=v;(t=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){i=e,c=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function c(){}function s(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(l(t={},r,(function(){return this})),t),p=d.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=d,l(p,"constructor",d),l(d,"constructor",s),s.displayName="GeneratorFunction",l(d,o,"GeneratorFunction"),l(p),l(p,o,"Generator"),l(p,r,(function(){return this})),l(p,"toString",(function(){return"[object Generator]"})),(u=function(){return{w:i,m:v}})()}function l(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},l(e,t,n,r)}function d(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,c,"next",e)}function c(e){d(i,r,o,a,c,"throw",e)}a(void 0)}))}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}const m=function(){return e=function e(t){var n=t.header,r=t.nav,o=t.content,i=t.footer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._header=n,this._nav=r,this._content=o,this._footer=i,this._currentPage=null,this._initialAppShell(),this._updateLoginStatusUI()},t=[{key:"_initialAppShell",value:function(){console.log("App shell initialized.");var e=this._header.querySelector(".hamburger-button"),t=this._nav;e&&t&&(e.addEventListener("click",(function(n){n.stopPropagation(),t.classList.toggle("open"),e.setAttribute("aria-expanded",t.classList.contains("open"))})),document.body.addEventListener("click",(function(n){t.classList.contains("open")&&(t.contains(n.target)||e.contains(n.target)||(t.classList.remove("open"),e.setAttribute("aria-expanded","false")))})),t.querySelectorAll("a").forEach((function(n){n.addEventListener("click",(function(){t.classList.contains("open")&&(t.classList.remove("open"),e.setAttribute("aria-expanded","false"))}))})))}},{key:"_updateLoginStatusUI",value:function(){var e=this,t=this._nav.querySelector("#auth-link"),n=this._nav.querySelector("#home-link"),r=this._nav.querySelector(".user-info-container");if(r&&r.remove(),(r=document.createElement("li")).className="user-info-container",i.A.isUserLoggedIn()){n&&(n.href="#/feed"),t&&(t.textContent="Logout",t.href="#/logout",t.onclick=function(t){t.preventDefault(),i.A.clearSession(),c.A.info("Anda telah logout."),e._updateLoginStatusUI(),window.location.hash="#/login"});var o=i.A.getUserName();if(o){var a=document.createElement("span");a.className="user-info",a.textContent="Hi, ".concat(o,"!"),r.appendChild(a)}t&&t.parentElement&&t.parentElement.insertAdjacentElement("beforebegin",r)}else n&&(n.href="#/"),t&&(t.textContent="Login",t.href="#/login",t.onclick=null);this._updateActiveNavLink()}},{key:"_updateActiveNavLink",value:function(){var e=window.location.hash.slice(1).toLowerCase()||"/";"/"===e?e=i.A.isUserLoggedIn()?"/feed":"/login":"logout"===e&&(e="/login"),this._nav.querySelectorAll("ul li a").forEach((function(t){t.classList.remove("active");var n=t.getAttribute("href"),r=n.startsWith("#")?n.slice(1).toLowerCase()||"/":n.toLowerCase()||"/";"home-link"===t.id&&(r=i.A.isUserLoggedIn()?"/feed":"/login"),r===e&&t.classList.add("active")}))}},{key:"renderPage",value:(n=f(u().m((function e(){var t,n,s,l,d,p,v,m,y,h,b,g=this;return u().w((function(e){for(;;)switch(e.n){case 0:if(this._updateLoginStatusUI(),t=r.A.parseActiveUrlWithCombiner(),s=n=t,(l=r.A.parseActiveUrlWithoutCombiner(n.slice(1))).id&&l.resource&&(s="/".concat(l.resource,"/:id")),d=i.A.isUserLoggedIn(),p=["/feed","/add-story","/story/:id"],v=["/login","/register"],!d){e.n=3;break}if(m=t,(y=r.A.parseActiveUrlWithoutCombiner(t.slice(1))).id&&y.resource&&(m="/".concat(y.resource,"/:id")),!v.includes(m)&&"/"!==m){e.n=2;break}if(n="/feed","#/feed"===window.location.hash){e.n=1;break}return window.location.hash="#/feed",e.a(2);case 1:s="/feed";case 2:e.n=5;break;case 3:if(!p.includes(s)){e.n=5;break}if(c.A.info("Anda harus login untuk mengakses halaman ini."),n="/login","#/login"===window.location.hash){e.n=4;break}return window.location.hash="#/login",e.a(2);case 4:s="/login";case 5:if(h=o.A[s]||o.A["/404"],b=function(){var e=f(u().m((function e(){var t;return u().w((function(e){for(;;)switch(e.n){case 0:if(!g._currentPage||"function"!=typeof g._currentPage.beforeLeave){e.n=1;break}return e.n=1,g._currentPage.beforeLeave();case 1:return e.n=2,h.render();case 2:if(g._content.innerHTML=e.v,"function"!=typeof h.afterRender){e.n=3;break}return e.n=3,h.afterRender(g._content);case 3:g._currentPage=h,window.scrollTo(0,0),(t=document.querySelector("#main-content"))&&(t.setAttribute("tabindex","-1"),t.focus()),g._updateActiveNavLink();case 4:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}(),!document.startViewTransition||this._currentPage===h){e.n=6;break}a.A.handlePageTransition(b),e.n=7;break;case 6:return e.n=7,b();case 7:return e.a(2)}}),e,this)}))),function(){return n.apply(this,arguments)})}],t&&p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}()},8824:(e,t,n)=>{n.d(t,{A:()=>m});var r,o=n(8535),i=n(9083),a=n(4539),c=n(5340),s=n(1347);function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return l(u,"_invoke",function(n,r,o){var i,c,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function p(n,r){for(c=n,s=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[4]||3,s=i[5]===e?i[3]:i[5],i[4]=3,i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(c=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,c=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),c=l,s=v;(t=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){i=e,c=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function c(){}function s(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(l(t={},r,(function(){return this})),t),p=d.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=d,l(p,"constructor",d),l(d,"constructor",s),s.displayName="GeneratorFunction",l(d,o,"GeneratorFunction"),l(p),l(p,o,"Generator"),l(p,r,(function(){return this})),l(p,"toString",(function(){return"[object Generator]"})),(u=function(){return{w:i,m:v}})()}function l(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},l(e,t,n,r)}function d(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,c,"next",e)}function c(e){d(i,r,o,a,c,"throw",e)}a(void 0)}))}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p.apply(null,arguments)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}const m=r={_presenter:null,_mapPickerInitialized:!1,render:function(){return f(u().m((function e(){return u().w((function(e){for(;;)if(0===e.n)return e.a(2,'\n      <div class="add-story-container auth-container"> <h2>Bagikan Cerita Baru Anda</h2>\n        <form id="addStoryForm" enctype="multipart/form-data">\n          <div class="form-group">\n            <label for="storyDescription">Deskripsi:</label>\n            <textarea id="storyDescription" name="description" rows="5" required aria-describedby="descriptionHelp"></textarea>\n            <small id="descriptionHelp" class="form-text text-muted">Ceritakan kisah Anda.</small>\n          </div>\n\n          <div class="form-group">\n            <label for="storyPhotoSource">Sumber Foto:</label>\n            <div class="photo-source-options">\n                <button type="button" id="useCameraButton" class="button button-outline">Gunakan Kamera</button>\n                <span style="margin: 0 8px;">atau</span>\n                <label for="storyPhotoFile" class="button button-outline">Pilih File Gambar</label>\n                <input type="file" id="storyPhotoFile" name="photo" accept="image/*" class="file-input-hidden" aria-label="Pilih file gambar">\n            </div>\n            <video id="cameraFeed" class="camera-feed hidden" autoplay playsinline aria-label="Tampilan kamera"></video>\n            <canvas id="photoCanvas" class="hidden" aria-hidden="true"></canvas>\n            <button type="button" id="capturePhotoButton" class="button hidden">Ambil Foto</button>\n            <button type="button" id="stopCameraButton" class="button button-danger hidden">Tutup Kamera</button>\n            <img id="previewPhoto" src="#" alt="Pratinjau Foto" class="preview-image hidden">\n          </div>\n\n          <div class="form-group">\n            <label for="map-picker">Lokasi Cerita (opsional, klik pada peta):</label>\n            <div id="map-picker" style="height: 300px; width: 100%; border: 1px solid var(--color-border);">\n                Memuat peta...\n            </div>\n            <input type="hidden" id="latitude" name="lat" aria-label="Latitude">\n            <input type="hidden" id="longitude" name="lon" aria-label="Longitude">\n            <p>Koordinat: <span id="coords-display">Belum dipilih</span></p>\n          </div>\n\n          <button type="submit" id="submitStoryButton" class="button button-primary">Publikasikan Cerita</button>\n        </form>\n        <div id="add-story-message-container">\n            <p id="add-story-message" class="message"></p>\n        </div>\n        <div id="add-story-loader" class="loader-container hidden">\n            <div class="loader"></div>\n            <p id="add-story-loading-text">Mengunggah...</p>\n        </div>\n      </div>\n    ')}),e)})))()},afterRender:function(){var e=this;return f(u().m((function t(){return u().w((function(t){for(;;)switch(t.n){case 0:if(e._presenter=new o.A({view:e}),i.A.isUserLoggedIn()){t.n=1;break}return e.redirectToLogin(),t.a(2);case 1:e._initFormInteractions(),e._initCamera(),e._mapPickerInitialized||(e._initMapPicker(),e._mapPickerInitialized=!0),console.log("AddStoryPage rendered and presenter initialized.");case 2:return t.a(2)}}),t)})))()},destroy:function(){var e,t,n;this.cameraService&&this.cameraService.stopCamera(),(e=r,t=this,"function"==typeof(n=p(v(1&2?e.prototype:e),"destroy",t))?function(e){return n.apply(t,e)}:n)([]),console.log("AddStoryPageView destroyed and camera stream stopped.")},_initFormInteractions:function(){var e=this,t=document.querySelector("#addStoryForm"),n=document.querySelector("#storyPhotoFile"),r=document.querySelector("#previewPhoto");n&&n.addEventListener("change",(function(e){if(e.target.files&&e.target.files[0]){var t=new FileReader;t.onload=function(e){r.src=e.target.result,r.classList.remove("hidden")},t.readAsDataURL(e.target.files[0]),a.A.stopStream()}})),t&&t.addEventListener("submit",function(){var t=f(u().m((function t(r){var o,i,c,s,l;return u().w((function(t){for(;;)switch(t.n){case 0:if(r.preventDefault(),o=document.querySelector("#storyDescription").value,i=a.A.getCapturedFile()||n.files[0],c=document.querySelector("#latitude").value,s=document.querySelector("#longitude").value,o&&i){t.n=1;break}return e.displayError("Deskripsi dan foto wajib diisi."),t.a(2);case 1:return(l=new FormData).append("description",o),l.append("photo",i,i.name),c&&s&&(l.append("lat",parseFloat(c)),l.append("lon",parseFloat(s))),t.n=2,e._presenter.submitStory(l);case 2:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}())},_initCamera:function(){var e=document.querySelector("#useCameraButton"),t=document.querySelector("#capturePhotoButton"),n=document.querySelector("#stopCameraButton"),r=document.querySelector("#cameraFeed"),o=document.querySelector("#photoCanvas"),i=document.querySelector("#storyPhotoFile"),c=document.querySelector("#previewPhoto");a.A.init({cameraFeedElement:r,photoCanvasElement:o,photoInputElement:i,previewPhotoElement:c,captureTriggerElement:t}),e&&e.addEventListener("click",(function(){a.A.startCamera(),e.classList.add("hidden"),t.classList.remove("hidden"),n.classList.remove("hidden"),i&&(i.value=""),c&&c.classList.add("hidden")})),t&&t.addEventListener("click",(function(){a.A.capturePhoto()})),n&&n.addEventListener("click",(function(){a.A.stopStream(),e.classList.remove("hidden"),t.classList.add("hidden"),n.classList.add("hidden")}))},_initMapPicker:function(){var e=document.querySelector("#latitude"),t=document.querySelector("#longitude"),n=document.querySelector("#coords-display");setTimeout((function(){var r=document.getElementById("map-picker");r&&null!==r.offsetParent?c.A.initLocationPicker({mapId:"map-picker",latInput:e,lonInput:t,coordsDisplayElement:n}):(console.warn("Map picker element not ready or not visible."),r&&(r.innerHTML="Peta tidak dapat dimuat. Coba refresh."))}),100)},showLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Mengunggah...",t=document.querySelector("#add-story-loader"),n=document.querySelector("#add-story-loading-text"),r=document.querySelector("#submitStoryButton");t&&t.classList.remove("hidden"),n&&(n.textContent=e),r&&(r.disabled=!0),this.clearMessage()},hideLoading:function(){var e=document.querySelector("#add-story-loader"),t=document.querySelector("#submitStoryButton");e&&e.classList.add("hidden"),t&&(t.disabled=!1)},displaySuccess:function(e){var t=document.querySelector("#add-story-message");t&&(t.textContent=e,t.className="message success-message"),s.A.success(e),this.resetFormVisuals()},displayError:function(e){var t=document.querySelector("#add-story-message");t&&(t.textContent=e,t.className="message error-message"),s.A.error(e)},clearMessage:function(){var e=document.querySelector("#add-story-message");e&&(e.textContent="")},resetForm:function(){var e=document.querySelector("#addStoryForm");e&&e.reset(),this.resetFormVisuals()},resetFormVisuals:function(){var e,t,n,r=document.querySelector("#previewPhoto"),o=document.querySelector("#coords-display"),i=document.querySelector("#storyPhotoFile");r&&(r.src="#",r.classList.add("hidden")),o&&(o.textContent="Belum dipilih"),i&&(i.value=""),a.A.stopStream(),a.A.clearCapturedFile(),null===(e=document.querySelector("#useCameraButton"))||void 0===e||e.classList.remove("hidden"),null===(t=document.querySelector("#capturePhotoButton"))||void 0===t||t.classList.add("hidden"),null===(n=document.querySelector("#stopCameraButton"))||void 0===n||n.classList.add("hidden"),this._mapPickerInitialized},redirectToLogin:function(){s.A.info("Anda harus login untuk menambahkan cerita."),i.A.clearSession(),window.location.hash="#/login"}}},9138:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(627),o=n(8376),i=n(9083),a=n(9791),c=n(5340),s=n(1347);function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return l(u,"_invoke",function(n,r,o){var i,c,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function p(n,r){for(c=n,s=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[4]||3,s=i[5]===e?i[3]:i[5],i[4]=3,i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(c=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,c=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),c=l,s=v;(t=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){i=e,c=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function c(){}function s(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(l(t={},r,(function(){return this})),t),p=d.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=d,l(p,"constructor",d),l(d,"constructor",s),s.displayName="GeneratorFunction",l(d,o,"GeneratorFunction"),l(p),l(p,o,"Generator"),l(p,r,(function(){return this})),l(p,"toString",(function(){return"[object Generator]"})),(u=function(){return{w:i,m:v}})()}function l(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},l(e,t,n,r)}function d(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,c,"next",e)}function c(e){d(i,r,o,a,c,"throw",e)}a(void 0)}))}}const p={_story:null,render:function(){return f(u().m((function e(){return u().w((function(e){for(;;)if(0===e.n)return e.a(2,'\n      <div class="detail-story-container content">\n        <div id="story-detail-content">\n          <div class="loader-container"><div class="loader"></div><p>Memuat detail cerita...</p></div>\n        </div>\n      </div>\n    ')}),e)})))()},afterRender:function(){var e=this;return f(u().m((function t(){var n,s,l,d,f,p;return u().w((function(t){for(;;)switch(t.n){case 0:if(n=r.A.parseActiveUrlWithoutCombiner(),s=n.id){t.n=1;break}return e.showError("ID cerita tidak ditemukan di URL."),t.a(2);case 1:if(l=i.A.getUserToken()){t.n=2;break}return e.redirectToLogin(),t.a(2);case 2:return d=document.querySelector("#story-detail-content"),t.p=3,t.n=4,o.A.getStoryDetail(s,l);case 4:if(!(f=t.v).error){t.n=5;break}return e.showError(f.message||"Gagal mengambil detail cerita."),f.message&&f.message.toLowerCase().includes("not found")&&(d.innerHTML='<p class="error-message">Sepertinya Cerita Tidak Disimpan di Server</p>'),t.a(2);case 5:e._story=f.story,d.innerHTML=(0,a.Z)(e._story),e._story.lat&&e._story.lon&&setTimeout((function(){var t="map-detail-".concat(e._story.id),n=document.getElementById(t);n&&null!==n.offsetParent?c.A.displayStoryMap(t,e._story.lat,e._story.lon,"Lokasi ".concat(e._story.name)):(console.warn("Map container ".concat(t," for story detail is not visible. Map not initialized.")),n&&(n.innerHTML="Peta tidak dapat ditampilkan (kontainer tidak terlihat)."))}),200),t.n=7;break;case 6:t.p=6,p=t.v,console.error("Error fetching story detail:",p),e.showError("Terjadi kesalahan sistem saat mengambil detail cerita.");case 7:return t.a(2)}}),t,null,[[3,6]])})))()},showError:function(e){var t=document.querySelector("#story-detail-content");t&&(t.innerHTML='<p class="error-message">'.concat(e,"</p>")),s.A.error(e)},redirectToLogin:function(){s.A.info("Sesi Anda berakhir atau Anda belum login. Silakan login kembali."),setTimeout((function(){i.A.clearSession(),window.location.hash="#/login"}),1500)}}}}]);
//# sourceMappingURL=app~ca0940c6.e02b95f9f216bfedc31e.bundle.js.map